import{c as k,j as e,m as f,a as j,Q as C,B as o,C as v,p as P,r as i,a4 as S,a5 as I,a6 as L,a7 as Q,a8 as R,A as D,n as U,Y as $,aa as B,ab as A,ad as O,z as X,a3 as q,U as b,T as H,i as V,k as y,l as w}from"./index-BgocD5L7.js";import{U as F}from"./index-CIdSBVH7.js";import{P as G}from"./ProgressRing-k2V-Ngad.js";import{X as W}from"./XpBadge-Cp3WWT_-.js";import{P as Y}from"./PhotoGallery-BGSh8gHl.js";import{A as _}from"./arrow-left-5QuJQRnE.js";import"./index-CjMpJ_-H.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=k("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=k("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);function Z({challenges:r,completedIds:l,onChallengeClick:s}){return e.jsx("div",{className:"space-y-3",children:r.map((a,n)=>{const t=l.includes(a.id);return e.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.05},className:j("relative flex items-center gap-4 p-4 rounded-xl border transition-all",t?"bg-green-500/10 border-green-500/30":"bg-card border-border hover:border-primary/40 cursor-pointer"),onClick:()=>!t&&s(a),children:[e.jsx("div",{className:j("flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",t?"bg-green-500 text-white":"bg-secondary text-muted-foreground"),children:t?e.jsx(C,{className:"w-4 h-4"}):a.order}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:j("font-medium text-sm",t&&"line-through text-muted-foreground"),children:a.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:a.description})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx(W,{xp:a.xpReward,size:"sm",showIcon:!1}),!t&&e.jsx(o,{size:"icon",variant:"ghost",className:"h-8 w-8",children:e.jsx(v,{className:"w-4 h-4"})})]})]},a.id)})})}function ee({open:r,onOpenChange:l,eventName:s,accessCode:a}){const{toast:n}=P(),[t,c]=i.useState(!1),d=`Присоединяйся к событию "${s}"!

Код: ${a}

Скачай приложение SnapQuest и введи код.`,p=async()=>{await navigator.clipboard.writeText(a),c(!0),n({title:"Код скопирован!"}),setTimeout(()=>c(!1),2e3)},m=async()=>{try{await navigator.share({title:`Приглашение на ${s}`,text:d})}catch{await navigator.clipboard.writeText(d),n({title:"Приглашение скопировано!"})}};return e.jsx(S,{open:r,onOpenChange:l,children:e.jsxs(I,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx(Q,{className:"text-center",children:"Пригласить участников"}),e.jsx(R,{className:"text-center",children:"Поделитесь кодом с друзьями, чтобы они присоединились к событию"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-6 py-4",children:[e.jsx("div",{className:"w-48 h-48 rounded-2xl bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"w-24 h-24 text-black mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-black/50",children:"QR-код"})]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-sm text-muted-foreground text-center mb-2",children:"Код доступа"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 px-4 py-3 rounded-xl bg-secondary border border-border font-mono text-xl text-center tracking-widest",children:a}),e.jsx(o,{size:"icon",variant:"outline",onClick:p,className:"h-12 w-12",children:t?e.jsx(C,{className:"w-5 h-5 text-green-500"}):e.jsx(J,{className:"w-5 h-5"})})]})]}),e.jsxs(o,{onClick:m,className:"w-full gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Поделиться приглашением"]})]})]})})}function de(){const r=U(),{id:l}=$(),[s,a]=i.useState(null),[n,t]=i.useState([]),[c,d]=i.useState([]),[p,m]=i.useState(!1);i.useEffect(()=>{const h=[...B(),...A].find(g=>g.id===l);if(h){a(h),O({eventId:l}).then(u=>{const M=X.filter(z=>z.eventId===l);t([...u,...M])});const g=h.challenges.slice(0,Math.floor(h.challenges.length*.3)).map(u=>u.id);d(g)}},[l]);const T=x=>{r(`/upload?event=${l}&eventChallenge=${x}`)};if(!s)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Событие не найдено"})});const E=new Date(s.startDate).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}),N=s.challenges.length>0?c.length/s.challenges.length*100:0;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>r("/events"),children:e.jsx(_,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold truncate max-w-[200px]",children:s.name}),e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>m(!0),children:e.jsx(D,{className:"w-5 h-5"})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative h-48 rounded-2xl overflow-hidden",children:[s.coverImage?e.jsx("img",{src:s.coverImage,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary/30 to-accent/30"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm text-xs font-medium",children:F.events.eventTypes[s.eventType]})}),e.jsx("h2",{className:"font-display text-2xl font-bold text-white mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-white/70",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4"}),E]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-4 h-4"}),s.participantsCount]})]})]}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("span",{className:"px-3 py-1.5 rounded-lg bg-black/50 backdrop-blur-sm text-sm font-mono",children:s.accessCode})})]}),e.jsx("p",{className:"text-muted-foreground",children:s.description}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-2xl border border-border p-4 flex items-center gap-4",children:[e.jsx(G,{progress:N,size:64,strokeWidth:5,children:e.jsxs("span",{className:"text-sm font-bold",children:[Math.round(N),"%"]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[c.length," из ",s.challenges.length," заданий"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Выполнено вами"})]})]}),e.jsxs(H,{defaultValue:"challenges",className:"w-full",children:[e.jsxs(V,{className:"grid w-full grid-cols-2",children:[e.jsxs(y,{value:"challenges",className:"gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),"Задания"]}),e.jsxs(y,{value:"gallery",className:"gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Галерея"]})]}),e.jsx(w,{value:"challenges",className:"mt-4",children:e.jsx(Z,{challenges:s.challenges,completedIds:c,onChallengeClick:x=>T(x.id)})}),e.jsx(w,{value:"gallery",className:"mt-4",children:n.length>0?e.jsx(Y,{photos:n,columns:2}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(v,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Пока нет фотографий"}),e.jsx("p",{className:"text-sm",children:"Станьте первым!"})]})})]})]}),e.jsx(ee,{open:p,onOpenChange:m,eventName:s.name,accessCode:s.accessCode})]})}export{de as default};
