import{c as k,j as e,m as d,a as j,Q as C,B as u,C as P,R as v,V as H,n as X,Y as z,p as I,r as h,N as S,Z as T,s as E,_ as B}from"./index-BgocD5L7.js";import{X as g}from"./XpBadge-Cp3WWT_-.js";import{D as A}from"./DifficultyBadge-DYWUfAd-.js";import{U as N}from"./index-CIdSBVH7.js";import{L as D}from"./lightbulb-CYTMdC_x.js";import{P as y}from"./ProgressRing-k2V-Ngad.js";import{C as L}from"./circle-check-DK9LH3fE.js";import{A as R}from"./arrow-left-5QuJQRnE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=k("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);function U({task:n,isCompleted:t,order:r,onClick:s,showHint:l=!1}){return e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:r*.05},onClick:s,className:j("relative flex items-start gap-4 p-4 rounded-xl border transition-all cursor-pointer",t?"bg-green-500/10 border-green-500/30":"bg-card border-border hover:border-primary/40"),children:[e.jsx("div",{className:j("flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center font-bold",t?"bg-green-500 text-white":"bg-secondary text-muted-foreground"),children:t?e.jsx(C,{className:"w-5 h-5"}):e.jsx("span",{children:r})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:j("font-medium mb-1",t&&"line-through text-muted-foreground"),children:n.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:n.description}),l&&n.hint&&!t&&e.jsxs("div",{className:"flex items-start gap-2 p-2 rounded-lg bg-gold/10 border border-gold/20 text-sm",children:[e.jsx(D,{className:"w-4 h-4 text-gold flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gold",children:n.hint})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(g,{xp:n.xpReward,size:"sm",showIcon:!1}),n.bonusXp&&!t&&e.jsxs("span",{className:"text-xs text-gold",children:["+",n.bonusXp," бонус"]})]})]}),!t&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(u,{size:"icon",variant:"ghost",children:e.jsx(P,{className:"w-5 h-5"})})})]})}function W({hunt:n,progress:t,variant:r="detailed"}){const s=(t==null?void 0:t.tasksCompleted.length)||0,l=n.tasks.length,a=l>0?s/l*100:0,c=s===l&&l>0,o=(t==null?void 0:t.totalXpEarned)||0;return r==="compact"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{progress:a,size:48,strokeWidth:4,children:e.jsxs("span",{className:"text-xs font-bold",children:[Math.round(a),"%"]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[s," из ",l]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"заданий"})]})]}):e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-2xl border border-border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-display text-lg font-bold",children:"Прогресс"}),c&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-gold/20 text-gold text-sm font-medium",children:[e.jsx(v,{className:"w-4 h-4"}),"Завершено!"]})]}),e.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[e.jsx(y,{progress:a,size:80,strokeWidth:6,color:c?"stroke-green-500":"stroke-primary",children:e.jsxs("span",{className:"text-lg font-bold",children:[Math.round(a),"%"]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("span",{className:"text-3xl font-bold",children:s}),e.jsxs("span",{className:"text-muted-foreground",children:["/ ",l," заданий"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Заработано: ",e.jsxs("span",{className:"text-gold font-medium",children:[o," XP"]})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.tasks.map((m,p)=>{const f=t==null?void 0:t.tasksCompleted.includes(m.id);return e.jsxs(d.div,{initial:{scale:0},animate:{scale:1},transition:{delay:p*.05},className:"relative group",children:[f?e.jsx(L,{className:"w-6 h-6 text-green-500"}):e.jsx(H,{className:"w-6 h-6 text-muted-foreground/30"}),e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 rounded bg-popover text-popover-foreground text-xs whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:m.title})]},m.id)})})]})}function F(){const n=X(),{id:t}=z(),{toast:r}=I(),[s,l]=h.useState(null),[a,c]=h.useState(null),[o,m]=h.useState(!1);h.useEffect(()=>{const i=S.find(x=>x.id===t);if(i){l(i);const x=T(t);c(x||null)}},[t]);const p=()=>{if(!s)return;const i={id:E(),huntId:s.id,userId:"user-1",startedAt:new Date().toISOString(),tasksCompleted:[],totalXpEarned:0};B(s.id,i),c(i),r({title:"Охота началась!",description:"Удачи!"})},f=i=>{!s||!a||a.tasksCompleted.includes(i)||n(`/upload?huntTask=${i}`)};if(!s)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Охота не найдена"})});const b=a!==null,w=(a==null?void 0:a.completedAt)!==void 0;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>n("/hunts"),children:e.jsx(R,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold truncate max-w-[200px]",children:s.title}),e.jsx("div",{className:"w-10"})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative h-48 rounded-2xl overflow-hidden",children:[e.jsx("img",{src:s.coverImage,alt:s.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm text-xs font-medium",children:N.hunts.themes[s.theme]}),e.jsx(A,{difficulty:s.difficulty,size:"sm"}),e.jsx("span",{className:"px-2 py-1 rounded-full bg-white/20 backdrop-blur-sm text-xs font-medium",children:N.hunts.duration[s.duration]})]}),e.jsx("h2",{className:"font-display text-2xl font-bold text-white mb-1",children:s.title}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{xp:s.totalXp}),e.jsxs("span",{className:"text-sm text-white/70",children:[s.tasks.length," заданий"]})]})]})]}),e.jsx("p",{className:"text-muted-foreground",children:s.description}),b&&e.jsx(W,{hunt:s,progress:a}),b?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-display text-lg font-bold",children:"Задания"}),e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>m(!o),children:o?"Скрыть подсказки":"Показать подсказки"})]}),s.tasks.map((i,x)=>e.jsx(U,{task:i,order:x+1,isCompleted:(a==null?void 0:a.tasksCompleted.includes(i.id))||!1,onClick:()=>f(i.id),showHint:o},i.id))]}):e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-8",children:e.jsxs(u,{size:"lg",onClick:p,className:"gap-2 bg-gradient-to-r from-primary to-accent",children:[e.jsx(M,{className:"w-5 h-5"}),"Начать охоту"]})}),w&&e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gold/10 border border-gold/30 rounded-2xl p-6 text-center",children:[e.jsx(v,{className:"w-12 h-12 text-gold mx-auto mb-3"}),e.jsx("h3",{className:"font-display text-xl font-bold mb-2",children:"Поздравляем!"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Вы успешно завершили эту охоту"}),e.jsx(g,{xp:(a==null?void 0:a.totalXpEarned)||0,size:"lg"})]})]})]})}export{F as default};
