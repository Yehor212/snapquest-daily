import{c as I,r as l,j as e,a as L,n as V,p as M,B as n,m as p,J as u,an as j,L as z,V as B}from"./index-X3YY-C0S.js";import{S as _,a as $,b as U,c as X,d as D}from"./select-CdnrKtR6.js";import{U as w}from"./index-oazBVSES.js";import{b as H}from"./useEvents-Dksn9ptY.js";import{A as J}from"./arrow-left-CtnlzYUZ.js";import{P as O}from"./plus-Cfo8BkCc.js";import{A as q}from"./arrow-right-Csc4S8dO.js";import"./index-ODAm_FIq.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=I("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),C=l.forwardRef(({className:c,...d},o)=>e.jsx("textarea",{className:L("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",c),ref:o,...d}));C.displayName="Textarea";const K=[{title:"Групповое фото",description:"Соберите всех вместе!",xpReward:50},{title:"Селфи с организатором",description:"Найдите хозяина праздника",xpReward:40},{title:"Лучший момент",description:"Поймайте самый яркий кадр",xpReward:60}];function re(){const c=V(),{toast:d}=M(),o=H(),[r,N]=l.useState(1),[x,k]=l.useState(""),[m,R]=l.useState(""),[g,S]=l.useState("party"),[i,v]=l.useState(K),T=()=>{v([...i,{title:"",description:"",xpReward:30}])},E=s=>{v(i.filter((t,a)=>a!==s))},f=(s,t,a)=>{const b=[...i];b[s]={...b[s],[t]:a},v(b)},A=()=>{r<3&&N(r+1)},y=()=>{r>1?N(r-1):c("/events")},F=async()=>{try{const s=i.filter(a=>a.title.trim()).map(a=>({title:a.title,description:a.description||void 0,xpReward:a.xpReward||30})),t=await o.mutateAsync({name:x,eventType:g,description:m||void 0,challenges:s});if(t)d({title:"Событие создано!",description:`Код доступа: ${t.access_code}`}),c(`/events/${t.id}`);else throw new Error("Failed to create event")}catch{d({title:"Ошибка",description:"Не удалось создать событие",variant:"destructive"})}},P=r===1?x.trim().length>0:!0,h=o.isPending;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:y,disabled:h,children:e.jsx(J,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold",children:"Создать событие"}),e.jsx("div",{className:"w-10"})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6",children:[e.jsx("div",{className:"flex items-center justify-center gap-2 mb-8",children:[1,2,3].map(s=>e.jsx("div",{className:`w-3 h-3 rounded-full transition-colors ${s<=r?"bg-primary":"bg-secondary"}`},s))}),r===1&&e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"font-display text-2xl font-bold mb-2",children:"Основная информация"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Дайте название вашему событию"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",children:"Название события *"}),e.jsx(j,{id:"name",placeholder:"Например: Свадьба Анны и Максима",value:x,onChange:s=>k(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"description",children:"Описание"}),e.jsx(C,{id:"description",placeholder:"Расскажите гостям о событии",value:m,onChange:s=>R(s.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"type",children:"Тип события"}),e.jsxs(_,{value:g,onValueChange:s=>S(s),children:[e.jsx($,{children:e.jsx(U,{})}),e.jsx(X,{children:Object.entries(w.events.eventTypes).map(([s,t])=>e.jsx(D,{value:s,children:t},s))})]})]})]})]}),r===2&&e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"font-display text-2xl font-bold mb-2",children:"Задания"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Добавьте фото-челленджи для гостей"})]}),e.jsxs("div",{className:"space-y-4",children:[i.map((s,t)=>e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-xl border border-border bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Задание ",t+1]}),i.length>1&&e.jsx(n,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>E(t),children:e.jsx(G,{className:"w-4 h-4 text-destructive"})})]}),e.jsx(j,{placeholder:"Название задания",value:s.title||"",onChange:a=>f(t,"title",a.target.value)}),e.jsx(j,{placeholder:"Описание (необязательно)",value:s.description||"",onChange:a=>f(t,"description",a.target.value)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"text-xs",children:"XP:"}),e.jsx(j,{type:"number",className:"w-20",value:s.xpReward||30,onChange:a=>f(t,"xpReward",parseInt(a.target.value)||30)})]})]},t)),e.jsxs(n,{variant:"outline",className:"w-full gap-2",onClick:T,children:[e.jsx(O,{className:"w-4 h-4"}),"Добавить задание"]})]})]}),r===3&&e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"font-display text-2xl font-bold mb-2",children:"Всё готово!"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Проверьте информацию перед созданием"})]}),e.jsxs("div",{className:"p-6 rounded-2xl border border-border bg-card space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Название"}),e.jsx("p",{className:"font-medium",children:x})]}),m&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Описание"}),e.jsx("p",{children:m})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Тип"}),e.jsx("p",{children:w.events.eventTypes[g]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Задания"}),e.jsxs("p",{children:[i.filter(s=>s.title).length," шт."]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"После создания вы получите уникальный код для приглашения гостей"})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-background border-t border-border",children:e.jsxs("div",{className:"container mx-auto max-w-md flex gap-3",children:[r>1&&e.jsx(n,{variant:"outline",onClick:y,className:"flex-1",disabled:h,children:"Назад"}),r<3?e.jsxs(n,{onClick:A,disabled:!P,className:"flex-1 gap-2",children:["Далее",e.jsx(q,{className:"w-4 h-4"})]}):e.jsx(n,{onClick:F,disabled:h,className:"flex-1 gap-2 bg-gradient-to-r from-primary to-accent",children:h?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 animate-spin"}),"Создание..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4"}),"Создать событие"]})})]})})]})]})}export{re as default};
