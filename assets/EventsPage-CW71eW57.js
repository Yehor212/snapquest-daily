import{c as L,j as e,a2 as S,a3 as v,a4 as w,a5 as T,m as x,a6 as _,a7 as g,C as A,R as I,r as p,a8 as P,a9 as O,aa as J,ab as U,ac as R,L as N,B as u,n as F,p as $,ad as z}from"./index-DFnNWw_v.js";import{U as B}from"./index-CIdSBVH7.js";import{u as H,j as M,a as q}from"./useEvents-Ck_OYwA_.js";import{A as G}from"./arrow-right-BHXhbbhq.js";import{E as V}from"./EmptyState-DMHY_pxE.js";import{A as X}from"./arrow-left-kcRMWkuC.js";import{P as C}from"./plus-rVyqma5O.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=L("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function Q({value:a,onChange:d,length:l=8,onComplete:o}){const r=n=>{const t=n.toUpperCase();d(t),t.length===l&&o&&o(t)},i=Math.floor(l/2);return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(S,{maxLength:l,value:a,onChange:r,className:"gap-2",children:[e.jsx(v,{children:Array.from({length:i}).map((n,t)=>e.jsx(w,{index:t,className:"w-10 h-12 text-lg font-mono uppercase bg-secondary border-border"},t))}),e.jsx(T,{}),e.jsx(v,{children:Array.from({length:l-i}).map((n,t)=>e.jsx(w,{index:t+i,className:"w-10 h-12 text-lg font-mono uppercase bg-secondary border-border"},t+i))})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Введите ",l,"-значный код приглашения"]})]})}function b({event:a,participantsCount:d=0,challengesCount:l=0,onClick:o}){const i=(a.start_date?new Date(a.start_date):new Date(a.created_at)).toLocaleDateString("ru-RU",{day:"numeric",month:"short"}),n={draft:"bg-yellow-500/20 text-yellow-400",active:"bg-green-500/20 text-green-400",completed:"bg-muted text-muted-foreground",archived:"bg-muted text-muted-foreground"},t={draft:"Черновик",active:"Активно",completed:"Завершено",archived:"В архиве"},c=B.events.eventTypes[a.event_type]||a.event_type;return e.jsxs(x.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:o,className:"bg-card rounded-2xl border border-border overflow-hidden cursor-pointer group",children:[e.jsxs("div",{className:"relative h-32 overflow-hidden",children:[a.cover_image?e.jsx("img",{src:a.cover_image,alt:a.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary/20 to-accent/20"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"px-2 py-1 rounded-full bg-black/50 backdrop-blur-sm text-xs font-medium text-white",children:c})}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n[a.status]}`,children:t[a.status]})}),e.jsx("div",{className:"absolute bottom-3 right-3",children:e.jsx("span",{className:"px-2 py-1 rounded bg-white/20 backdrop-blur-sm text-xs font-mono text-white",children:a.access_code})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-display text-lg font-bold mb-1 group-hover:text-primary transition-colors",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1 mb-4",children:a.description||"Нет описания"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-4 h-4"}),i]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4"}),d]}),l>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-4 h-4"}),l]})]}),e.jsx(I,{className:"w-5 h-5 text-muted-foreground group-hover:text-primary group-hover:translate-x-1 transition-all"})]})]})]})}function W({open:a,onOpenChange:d,onJoin:l}){const[o,r]=p.useState(""),[i,n]=p.useState(null),[t,c]=p.useState(null),[h,f]=p.useState(!1),s=H(),m=j=>{r(j),n(null),c(null)},k=async j=>{f(!0),n(null);try{const y=await M(j);y?(c(y),n(null)):(n("Событие не найдено. Проверьте код."),c(null))}catch{n("Ошибка при поиске события"),c(null)}finally{f(!1)}},E=()=>{t&&(l(t),d(!1),r(""),c(null))},D=()=>{d(!1),r(""),n(null),c(null)};return e.jsx(P,{open:a,onOpenChange:D,children:e.jsxs(O,{className:"sm:max-w-md",children:[e.jsxs(J,{children:[e.jsx(U,{className:"text-center",children:"Присоединиться к событию"}),e.jsx(R,{className:"text-center",children:"Введите код приглашения, полученный от организатора"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-6 py-4",children:[e.jsx(Q,{value:o,onChange:m,onComplete:k}),h&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(N,{className:"w-4 h-4 animate-spin"}),"Поиск события..."]}),i&&e.jsxs(x.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(K,{className:"w-4 h-4"}),i]}),t&&e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"w-full p-4 rounded-xl bg-secondary border border-border",children:[e.jsx("h4",{className:"font-medium mb-1",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:t.description||"Нет описания"}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4"}),"Приватное событие"]})})]}),e.jsx(u,{onClick:E,disabled:!t||s.isPending,className:"w-full gap-2",children:s.isPending?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 animate-spin"}),"Присоединение..."]}):e.jsxs(e.Fragment,{children:["Присоединиться",e.jsx(G,{className:"w-4 h-4"})]})})]})]})})}function le(){const a=F(),{toast:d}=$(),[l,o]=p.useState(!1),{data:r,isLoading:i}=q(),n=(r||[]).filter(s=>s.status==="active"),t=(r||[]).filter(s=>s.status==="draft"),c=(r||[]).filter(s=>s.status==="completed"||s.status==="archived"),h=s=>{a(`/events/${s}`)},f=s=>{d({title:"Вы присоединились!",description:`Добро пожаловать на "${s.name}"`}),a(`/events/${s.id}`)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>a(-1),children:e.jsx(X,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold",children:"Мои события"}),e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>a("/events/create"),children:e.jsx(C,{className:"w-5 h-5"})})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-secondary border border-border mb-4",children:[e.jsx(g,{className:"w-4 h-4 text-gold"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Фото-игры для компаний"})]}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-2",children:"Приватные события"}),e.jsx("p",{className:"text-muted-foreground text-sm max-w-md mx-auto",children:"Создавайте фото-челленджи для свадеб, вечеринок и тимбилдингов"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(u,{variant:"outline",className:"flex-1 gap-2",onClick:()=>o(!0),children:[e.jsx(z,{className:"w-4 h-4"}),"Присоединиться"]}),e.jsxs(u,{className:"flex-1 gap-2 bg-gradient-to-r from-primary to-accent",onClick:()=>a("/events/create"),children:[e.jsx(C,{className:"w-4 h-4"}),"Создать"]})]}),i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[n.length>0&&e.jsxs("section",{children:[e.jsx("h3",{className:"font-display text-lg font-bold mb-4",children:"Активные события"}),e.jsx("div",{className:"space-y-4",children:n.map((s,m)=>e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1},children:e.jsx(b,{event:s,onClick:()=>h(s.id)})},s.id))})]}),t.length>0&&e.jsxs("section",{children:[e.jsx("h3",{className:"font-display text-lg font-bold mb-4",children:"Черновики"}),e.jsx("div",{className:"space-y-4",children:t.map((s,m)=>e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1},children:e.jsx(b,{event:s,onClick:()=>h(s.id)})},s.id))})]}),c.length>0&&e.jsxs("section",{children:[e.jsx("h3",{className:"font-display text-lg font-bold mb-4",children:"Завершённые"}),e.jsx("div",{className:"space-y-4",children:c.map((s,m)=>e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1},children:e.jsx(b,{event:s,onClick:()=>h(s.id)})},s.id))})]}),(r||[]).length===0&&e.jsx(V,{icon:g,title:"Нет событий",description:"Создайте своё первое событие или присоединитесь к существующему",actionLabel:"Создать событие",onAction:()=>a("/events/create")})]})]}),e.jsx(W,{open:l,onOpenChange:o,onJoin:f})]})}export{le as default};
