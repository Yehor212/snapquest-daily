import{c as _,j as e,D as T,z as D,B as c,A as P,E as I,n as L,q as A,r as C,F,G as O,T as B,i as M,k as j,l as v,L as y,m as p,I as u}from"./index-X3YY-C0S.js";import{P as f}from"./PhotoGallery-BMZ1EmC1.js";import{E as x}from"./EmptyState-C4Y7FhQ9.js";import{A as z}from"./arrow-left-CtnlzYUZ.js";import{P as G}from"./plus-Cfo8BkCc.js";import"./index-DWgQ6eXM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=_("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=_("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function U({filter:t,onFilterChange:n}){var d;const i=[{value:"date",label:"По дате"},{value:"likes",label:"По лайкам"}],o=r=>{t.sortBy===r?n({sortOrder:t.sortOrder==="desc"?"asc":"desc"}):n({sortBy:r,sortOrder:"desc"})},m=()=>{n({isTop:t.isTop?void 0:!0})};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(T,{children:[e.jsx(D,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:(d=i.find(r=>r.value===t.sortBy))==null?void 0:d.label})]})}),e.jsx(P,{align:"end",children:i.map(r=>e.jsxs(I,{onClick:()=>o(r.value),children:[r.label,t.sortBy===r.value&&e.jsx("span",{className:"ml-2 text-muted-foreground",children:t.sortOrder==="desc"?"↓":"↑"})]},r.value))})]}),e.jsxs(c,{variant:t.isTop?"default":"outline",size:"sm",className:"gap-2",onClick:m,children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Только TOP"})]})]})}function Q(){const t=L(),{user:n}=A(),[i,o]=C.useState({sortBy:"date",sortOrder:"desc"}),{data:m,isLoading:d}=F(50),{data:r,isLoading:k}=O(n==null?void 0:n.id),b=a=>{o(s=>({...s,...a}))},h=(m||[]).filter(a=>!(i.isTop&&a.likes_count<10)).sort((a,s)=>{const l=i.sortOrder==="desc"?-1:1;return i.sortBy==="date"?l*(new Date(s.created_at).getTime()-new Date(a.created_at).getTime()):i.sortBy==="likes"?l*((s.likes_count||0)-(a.likes_count||0)):0}),g=(r||[]).sort((a,s)=>{const l=i.sortOrder==="desc"?-1:1;return i.sortBy==="date"?l*(new Date(s.created_at).getTime()-new Date(a.created_at).getTime()):i.sortBy==="likes"?l*((s.likes_count||0)-(a.likes_count||0)):0}),w=a=>a.map(s=>({id:s.id,userId:s.user_id,imageData:s.image_url,thumbnailData:s.thumbnail_url||s.image_url,createdAt:s.created_at,likes:s.likes_count,comments:0,isTop:s.likes_count>=10,challengeId:s.challenge_id||void 0,eventId:s.event_id||void 0,huntTaskId:s.hunt_task_id||void 0,filter:s.filter_applied||void 0,username:s.username||void 0,display_name:s.display_name||void 0,avatar_url:s.avatar_url||void 0})),N=a=>a.map(s=>({id:s.id,userId:s.user_id,imageData:s.image_url,thumbnailData:s.thumbnail_url||s.image_url,createdAt:s.created_at,likes:s.likes_count,comments:0,isTop:s.likes_count>=10,challengeId:s.challenge_id||void 0,eventId:s.event_id||void 0,huntTaskId:s.hunt_task_id||void 0,filter:s.filter_applied||void 0}));return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:e.jsx(z,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold",children:"Галерея"}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>t("/upload"),children:e.jsx(G,{className:"w-5 h-5"})})]})}),e.jsx("main",{className:"container mx-auto px-4 py-6",children:e.jsxs(B,{defaultValue:"all",className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(M,{children:[e.jsx(j,{value:"all",children:"Все"}),e.jsx(j,{value:"my",children:"Мои фото"})]}),e.jsx(U,{filter:i,onFilterChange:b})]}),e.jsx(v,{value:"all",children:d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(y,{className:"w-8 h-8 animate-spin text-primary"})}):h.length>0?e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(f,{photos:w(h),columns:3})}):e.jsx(x,{icon:u,title:"Пока нет фото",description:"Станьте первым, кто загрузит фото!",actionLabel:"Загрузить фото",onAction:()=>t("/upload")})}),e.jsx(v,{value:"my",children:n?k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(y,{className:"w-8 h-8 animate-spin text-primary"})}):g.length>0?e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(f,{photos:N(g),columns:3})}):e.jsx(x,{icon:u,title:"У вас пока нет фото",description:"Выполняйте челленджи и ваши фото появятся здесь",actionLabel:"Загрузить первое фото",onAction:()=>t("/upload")}):e.jsx(x,{icon:u,title:"Войдите в аккаунт",description:"Чтобы видеть свои фото, необходимо войти в аккаунт"})})]})})]})}export{Q as default};
