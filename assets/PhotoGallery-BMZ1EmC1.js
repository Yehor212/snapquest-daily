import{c as j,r as x,_ as k,y as C,j as e,m as o,B as _,X as S,ae as p,L as I,af as N,H as L,a7 as v,a as M}from"./index-X3YY-C0S.js";import{A as y}from"./index-DWgQ6eXM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=j("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=j("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);function D({photo:s,onClose:c}){var f;const[a,r]=x.useState(null),[u,n]=x.useState(!1);if(x.useEffect(()=>{if(!s){r(null);return}if(s.username||s.display_name){r({id:s.userId,username:s.username||null,display_name:s.display_name||null,avatar_url:s.avatar_url||null});return}s.userId&&k&&(n(!0),C.from("profiles").select("id, username, display_name, avatar_url").eq("id",s.userId).maybeSingle().then(({data:i})=>{r(i),n(!1)}).catch(()=>{n(!1)}))},[s==null?void 0:s.userId,s==null?void 0:s.username,s==null?void 0:s.display_name,s==null?void 0:s.avatar_url]),!s)return null;const d=new Date(s.createdAt).toLocaleDateString("ru-RU",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}),l=(a==null?void 0:a.display_name)||(a==null?void 0:a.username)||"Пользователь",t=(a==null?void 0:a.username)||"user",m=a==null?void 0:a.avatar_url,g=["bg-primary","bg-accent","bg-gold","bg-success"],h=g[l.length%g.length],w=i=>i.charAt(0).toUpperCase();return e.jsx(y,{children:s&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4",onClick:c,children:e.jsxs(o.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative w-full max-w-lg bg-card rounded-2xl overflow-hidden",onClick:i=>i.stopPropagation(),children:[e.jsx(_,{size:"icon",variant:"ghost",className:"absolute top-3 right-3 z-10 w-10 h-10 rounded-full bg-black/50 hover:bg-black/70",onClick:c,children:e.jsx(S,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative aspect-square",children:[e.jsx("img",{src:s.imageData,alt:"",className:"w-full h-full object-cover"}),s.isTop&&e.jsx("div",{className:"absolute top-3 left-3",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-gold/90 text-sm font-semibold text-black",children:[e.jsx(p,{className:"w-4 h-4"}),"TOP"]})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[u?e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(I,{className:"w-10 h-10 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"flex items-center gap-3",children:[m?e.jsx("img",{src:m,alt:l,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:`w-10 h-10 rounded-full ${h} flex items-center justify-center text-sm font-semibold text-primary-foreground`,children:w(l)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:l}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",t]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("button",{className:"flex items-center gap-2 text-muted-foreground hover:text-primary transition-colors",children:[e.jsx(N,{className:"w-5 h-5"}),e.jsx("span",{children:s.likes})]}),e.jsxs("button",{className:"flex items-center gap-2 text-muted-foreground hover:text-primary transition-colors",children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{children:s.comments})]}),e.jsx("button",{className:"flex items-center gap-2 text-muted-foreground hover:text-primary transition-colors",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),d]}),((f=s.metadata)==null?void 0:f.location)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-4 h-4"}),s.metadata.location.placeName||"Местоположение"]})]})]})]})})})}function P({photos:s,columns:c=3,onPhotoClick:a,showStats:r=!0,emptyMessage:u="Пока нет фотографий"}){const[n,d]=x.useState(null),l=t=>{a?a(t):d(t)};return s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-secondary flex items-center justify-center mb-4",children:e.jsx(v,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("p",{className:"text-muted-foreground",children:u})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:M("grid gap-2",c===2?"grid-cols-2":"grid-cols-3"),children:e.jsx(y,{children:s.map((t,m)=>e.jsxs(o.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{delay:m*.05},className:"relative aspect-square rounded-lg overflow-hidden bg-secondary cursor-pointer group",onClick:()=>l(t),children:[e.jsx("img",{src:t.imageData,alt:"",className:"w-full h-full object-cover transition-transform group-hover:scale-105",loading:"lazy"}),t.isTop&&e.jsx("div",{className:"absolute top-2 left-2",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gold/90 text-xs font-semibold text-black",children:[e.jsx(p,{className:"w-3 h-3"}),"TOP"]})}),r&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex items-center gap-3 text-white text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"w-3 h-3"}),t.likes]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),t.comments]})]})})]},t.id))})}),e.jsx(D,{photo:n,onClose:()=>d(null)})]})}export{P};
