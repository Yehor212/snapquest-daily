import{j as e,m,O as P,Q as z,R as E,n as B,r as y,B as F,U as b,L as R,T as U,i as V,k as w,l as k}from"./index-DFnNWw_v.js";import{S as C,a as T,b as _,c as H,d}from"./select-B8z26uNK.js";import{X}from"./XpBadge-D87dUz-C.js";import{D as A}from"./DifficultyBadge-BE_m_wR9.js";import{P as D}from"./ProgressRing-C_tbWcMw.js";import{U as x}from"./index-CIdSBVH7.js";import{C as I}from"./circle-check-CruBcSPz.js";import{E as L}from"./EmptyState-DMHY_pxE.js";import{b as O,c as M}from"./useHunts-BTPJHiU3.js";import{A as Q}from"./arrow-left-kcRMWkuC.js";import"./index-BTBWgO7J.js";function S({hunt:i,progress:a,taskCount:p=0,onClick:r}){var n;const c=((n=a==null?void 0:a.completed_tasks)==null?void 0:n.length)||0,l=p,u=l>0?c/l*100:0,h=(a==null?void 0:a.completed_at)!==null&&(a==null?void 0:a.completed_at)!==void 0,f=i.cover_image||"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=400&fit=crop";return e.jsxs(m.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:r,className:"bg-card rounded-2xl border border-border overflow-hidden cursor-pointer group",children:[e.jsxs("div",{className:"relative h-32 overflow-hidden",children:[e.jsx("img",{src:f,alt:i.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsxs("div",{className:"absolute top-3 left-3 flex gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full bg-black/50 backdrop-blur-sm text-xs font-medium text-white",children:x.hunts.themes[i.theme]||i.theme}),e.jsx(A,{difficulty:i.difficulty,size:"sm"})]}),h&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-500/90 text-xs font-semibold text-white",children:[e.jsx(I,{className:"w-3 h-3"}),"Завершено"]})}),e.jsx("div",{className:"absolute bottom-3 right-3",children:e.jsx(X,{xp:i.total_xp,size:"sm"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-display text-lg font-bold mb-1 group-hover:text-primary transition-colors",children:i.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-4",children:i.description||"Нет описания"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),x.hunts.duration[i.duration]||i.duration]}),l>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),l," заданий"]})]}),a?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(D,{progress:u,size:32,strokeWidth:3,children:e.jsxs("span",{className:"text-[10px] font-medium",children:[c,"/",l]})})}):e.jsx(E,{className:"w-5 h-5 text-muted-foreground group-hover:text-primary group-hover:translate-x-1 transition-all"})]})]})]})}function ae(){const i=B(),[a,p]=y.useState("all"),[r,c]=y.useState("all"),{data:l,isLoading:u}=O(),{data:h,isLoading:f}=M(),n=u||f,o=(h||[]).reduce((s,t)=>(s[t.hunt_id]=t,s),{}),v=(l||[]).filter(s=>!(a!=="all"&&s.theme!==a||r!=="all"&&s.difficulty!==r)),j=v.filter(s=>{const t=o[s.id];return!t||!t.completed_at}),g=v.filter(s=>{const t=o[s.id];return t&&t.completed_at}),N=s=>{i(`/hunts/${s}`)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>i(-1),children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold",children:"Фото-охота"}),e.jsx("div",{className:"w-10"})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-secondary border border-border mb-4",children:[e.jsx(b,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Исследуй мир"})]}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-2",children:"Фото-охота"}),e.jsx("p",{className:"text-muted-foreground text-sm max-w-md mx-auto",children:"Выполняйте серии заданий, исследуйте новые места и зарабатывайте XP"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(C,{value:a,onValueChange:s=>p(s),children:[e.jsx(T,{className:"w-[140px]",children:e.jsx(_,{placeholder:"Тема"})}),e.jsxs(H,{children:[e.jsx(d,{value:"all",children:"Все темы"}),Object.entries(x.hunts.themes).map(([s,t])=>e.jsx(d,{value:s,children:t},s))]})]}),e.jsxs(C,{value:r,onValueChange:s=>c(s),children:[e.jsx(T,{className:"w-[140px]",children:e.jsx(_,{placeholder:"Сложность"})}),e.jsxs(H,{children:[e.jsx(d,{value:"all",children:"Любая"}),Object.entries(x.hunts.difficulty).map(([s,t])=>e.jsx(d,{value:s,children:t},s))]})]})]}),n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(U,{defaultValue:"active",className:"w-full",children:[e.jsxs(V,{className:"grid w-full grid-cols-2",children:[e.jsxs(w,{value:"active",children:["Активные (",j.length,")"]}),e.jsxs(w,{value:"completed",children:["Завершённые (",g.length,")"]})]}),e.jsx(k,{value:"active",className:"mt-4 space-y-4",children:j.length>0?j.map((s,t)=>e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsx(S,{hunt:s,progress:o[s.id],taskCount:s.task_count||0,onClick:()=>N(s.id)})},s.id)):e.jsx(L,{icon:b,title:"Нет активных охот",description:"Выберите другие фильтры или посмотрите завершённые охоты"})}),e.jsx(k,{value:"completed",className:"mt-4 space-y-4",children:g.length>0?g.map((s,t)=>e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsx(S,{hunt:s,progress:o[s.id],taskCount:s.task_count||0,onClick:()=>N(s.id)})},s.id)):e.jsx(L,{icon:b,title:"Нет завершённых охот",description:"Начните первую охоту и завершите все задания"})})]})]})]})}export{ae as default};
