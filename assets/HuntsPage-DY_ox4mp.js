import{j as e,m as d,O as P,Q as z,R as E,n as B,r as y,B as F,U as g,L as R,T as U,i as V,k as w,l as k}from"./index-X3YY-C0S.js";import{S as C,a as T,b as _,c as H,d as o}from"./select-CdnrKtR6.js";import{X}from"./XpBadge-C-Cp13ih.js";import{D as A}from"./DifficultyBadge-D7p4uoUe.js";import{P as D}from"./ProgressRing-YFDnb-jb.js";import{U as m}from"./index-oazBVSES.js";import{C as O}from"./circle-check-81Fby8fS.js";import{E as L}from"./EmptyState-C4Y7FhQ9.js";import{b as G,c as I}from"./useHunts-fygRLs0X.js";import{A as M}from"./arrow-left-CtnlzYUZ.js";import"./index-ODAm_FIq.js";function S({hunt:a,progress:l,taskCount:x=0,onClick:c}){var r;const n=((r=l==null?void 0:l.completed_tasks)==null?void 0:r.length)||0,i=x,u=i>0?n/i*100:0,p=(l==null?void 0:l.completed_at)!==null&&(l==null?void 0:l.completed_at)!==void 0,h={city:"from-slate-700/60 to-slate-900/60",nature:"from-emerald-500/50 to-teal-900/60",home:"from-amber-400/50 to-orange-800/60",travel:"from-sky-500/50 to-indigo-900/60",seasonal:"from-fuchsia-500/50 to-purple-900/60"}[a.theme]||"from-primary/20 to-accent/20";return e.jsxs(d.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:c,className:"bg-card rounded-2xl border border-border overflow-hidden cursor-pointer group",children:[e.jsxs("div",{className:"relative h-32 overflow-hidden",children:[a.cover_image?e.jsx("img",{src:a.cover_image,alt:a.title,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}):e.jsx("div",{className:`w-full h-full bg-gradient-to-br ${h}`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsxs("div",{className:"absolute top-3 left-3 flex gap-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full bg-black/50 backdrop-blur-sm text-xs font-medium text-white",children:m.hunts.themes[a.theme]||a.theme}),e.jsx(A,{difficulty:a.difficulty,size:"sm"})]}),p&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-500/90 text-xs font-semibold text-white",children:[e.jsx(O,{className:"w-3 h-3"}),"Завершено"]})}),e.jsx("div",{className:"absolute bottom-3 right-3",children:e.jsx(X,{xp:a.total_xp,size:"sm"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-display text-lg font-bold mb-1 group-hover:text-primary transition-colors",children:a.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-4",children:a.description||"Нет описания"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),m.hunts.duration[a.duration]||a.duration]}),i>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),i," заданий"]})]}),l?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(D,{progress:u,size:32,strokeWidth:3,children:e.jsxs("span",{className:"text-[10px] font-medium",children:[n,"/",i]})})}):e.jsx(E,{className:"w-5 h-5 text-muted-foreground group-hover:text-primary group-hover:translate-x-1 transition-all"})]})]})]})}function ae(){const a=B(),[l,x]=y.useState("all"),[c,n]=y.useState("all"),{data:i,isLoading:u}=G(),{data:p,isLoading:b}=I(),h=u||b,r=(p||[]).reduce((s,t)=>(s[t.hunt_id]=t,s),{}),v=(i||[]).filter(s=>!(l!=="all"&&s.theme!==l||c!=="all"&&s.difficulty!==c)),f=v.filter(s=>{const t=r[s.id];return!t||!t.completed_at}),j=v.filter(s=>{const t=r[s.id];return t&&t.completed_at}),N=s=>{a(`/hunts/${s}`)};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-lg border-b border-border",children:e.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>a(-1),children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("h1",{className:"font-display text-lg font-semibold",children:"Фото-охота"}),e.jsx("div",{className:"w-10"})]})}),e.jsxs("main",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-secondary border border-border mb-4",children:[e.jsx(g,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Исследуй мир"})]}),e.jsx("h2",{className:"font-display text-2xl font-bold mb-2",children:"Фото-охота"}),e.jsx("p",{className:"text-muted-foreground text-sm max-w-md mx-auto",children:"Выполняйте серии заданий, исследуйте новые места и зарабатывайте XP"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(C,{value:l,onValueChange:s=>x(s),children:[e.jsx(T,{className:"w-[140px]",children:e.jsx(_,{placeholder:"Тема"})}),e.jsxs(H,{children:[e.jsx(o,{value:"all",children:"Все темы"}),Object.entries(m.hunts.themes).map(([s,t])=>e.jsx(o,{value:s,children:t},s))]})]}),e.jsxs(C,{value:c,onValueChange:s=>n(s),children:[e.jsx(T,{className:"w-[140px]",children:e.jsx(_,{placeholder:"Сложность"})}),e.jsxs(H,{children:[e.jsx(o,{value:"all",children:"Любая"}),Object.entries(m.hunts.difficulty).map(([s,t])=>e.jsx(o,{value:s,children:t},s))]})]})]}),h?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(U,{defaultValue:"active",className:"w-full",children:[e.jsxs(V,{className:"grid w-full grid-cols-2",children:[e.jsxs(w,{value:"active",children:["Активные (",f.length,")"]}),e.jsxs(w,{value:"completed",children:["Завершённые (",j.length,")"]})]}),e.jsx(k,{value:"active",className:"mt-4 space-y-4",children:f.length>0?f.map((s,t)=>e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsx(S,{hunt:s,progress:r[s.id],taskCount:s.task_count||0,onClick:()=>N(s.id)})},s.id)):e.jsx(L,{icon:g,title:"Нет активных охот",description:"Выберите другие фильтры или посмотрите завершённые охоты"})}),e.jsx(k,{value:"completed",className:"mt-4 space-y-4",children:j.length>0?j.map((s,t)=>e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},children:e.jsx(S,{hunt:s,progress:r[s.id],taskCount:s.task_count||0,onClick:()=>N(s.id)})},s.id)):e.jsx(L,{icon:g,title:"Нет завершённых охот",description:"Начните первую охоту и завершите все задания"})})]})]})]})}export{ae as default};
